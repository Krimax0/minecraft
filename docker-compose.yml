version: '3.8'

services:
  minecraft:
    image: itzg/minecraft-server:java21
    container_name: minecraft-neoforge
    restart: unless-stopped

    environment:
      EULA: "TRUE"
      TYPE: "NEOFORGE"
      VERSION: "1.21.1"
      NEOFORGE_VERSION: "21.1.172"
      MEMORY: "10G"

      # Нелицензионный сервер
      ONLINE_MODE: "FALSE"

      # Настройки сервера
      MOTD: "§6Модовый сервер NeoForge 1.21.1"
      MAX_PLAYERS: "20"
      DIFFICULTY: "normal"
      ALLOW_FLIGHT: "TRUE"
      VIEW_DISTANCE: "10"
      SIMULATION_DISTANCE: "10"

      # Оптимизация JVM
      USE_AIKAR_FLAGS: "TRUE"

    ports:
      - "25565:25565"

    volumes:
      # Папка с модами - просто положите моды сюда
      - ./mods:/data/mods

      # Конфиги модов
      - ./config:/data/config

      # Все данные сервера
      - ./data:/data

    stdin_open: true
    tty: true

    deploy:
      resources:
        limits:
          memory: 6G
        reservations:
          memory: 4G